{"dependencies":[{"name":"tslib","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"8R25577gwLd3n1hFG9VYnRLV9eE=","exportNames":["*"],"imports":1}},{"name":"./helper","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":35},"end":{"line":2,"column":40,"index":75}}],"key":"XzTjbTLZPqGBcKq7cSmvD13rCtQ=","exportNames":["*"],"imports":1}},{"name":"./types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":76},"end":{"line":3,"column":104,"index":180}}],"key":"iV91Bk2eI9buML90FP6cK2SM5h0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"FunctionsClient\", {\n    enumerable: true,\n    get: function () {\n      return FunctionsClient;\n    }\n  });\n  var _tslib = require(_dependencyMap[0], \"tslib\");\n  var _helper = require(_dependencyMap[1], \"./helper\");\n  var _types = require(_dependencyMap[2], \"./types\");\n  class FunctionsClient {\n    constructor(url, {\n      headers = {},\n      customFetch,\n      region = _types.FunctionRegion.Any\n    } = {}) {\n      this.url = url;\n      this.headers = headers;\n      this.region = region;\n      this.fetch = (0, _helper.resolveFetch)(customFetch);\n    }\n    /**\n     * Updates the authorization header\n     * @param token - the new jwt token sent in the authorisation header\n     */\n    setAuth(token) {\n      this.headers.Authorization = `Bearer ${token}`;\n    }\n    /**\n     * Invokes a function\n     * @param functionName - The name of the Function to invoke.\n     * @param options - Options for invoking the Function.\n     */\n    invoke(functionName_1) {\n      return (0, _tslib.__awaiter)(this, arguments, void 0, function* (functionName, options = {}) {\n        var _a;\n        try {\n          const {\n            headers,\n            method,\n            body: functionArgs,\n            signal\n          } = options;\n          let _headers = {};\n          let {\n            region\n          } = options;\n          if (!region) {\n            region = this.region;\n          }\n          // Add region as query parameter using URL API\n          const url = new URL(`${this.url}/${functionName}`);\n          if (region && region !== 'any') {\n            _headers['x-region'] = region;\n            url.searchParams.set('forceFunctionRegion', region);\n          }\n          let body;\n          if (functionArgs && (headers && !Object.prototype.hasOwnProperty.call(headers, 'Content-Type') || !headers)) {\n            if (typeof Blob !== 'undefined' && functionArgs instanceof Blob || functionArgs instanceof ArrayBuffer) {\n              // will work for File as File inherits Blob\n              // also works for ArrayBuffer as it is the same underlying structure as a Blob\n              _headers['Content-Type'] = 'application/octet-stream';\n              body = functionArgs;\n            } else if (typeof functionArgs === 'string') {\n              // plain string\n              _headers['Content-Type'] = 'text/plain';\n              body = functionArgs;\n            } else if (typeof FormData !== 'undefined' && functionArgs instanceof FormData) {\n              // don't set content-type headers\n              // Request will automatically add the right boundary value\n              body = functionArgs;\n            } else {\n              // default, assume this is JSON\n              _headers['Content-Type'] = 'application/json';\n              body = JSON.stringify(functionArgs);\n            }\n          } else {\n            // if the Content-Type was supplied, simply set the body\n            body = functionArgs;\n          }\n          const response = yield this.fetch(url.toString(), {\n            method: method || 'POST',\n            // headers priority is (high to low):\n            // 1. invoke-level headers\n            // 2. client-level headers\n            // 3. default Content-Type header\n            headers: Object.assign(Object.assign(Object.assign({}, _headers), this.headers), headers),\n            body,\n            signal\n          }).catch(fetchError => {\n            if (fetchError.name === 'AbortError') {\n              throw fetchError;\n            }\n            throw new _types.FunctionsFetchError(fetchError);\n          });\n          const isRelayError = response.headers.get('x-relay-error');\n          if (isRelayError && isRelayError === 'true') {\n            throw new _types.FunctionsRelayError(response);\n          }\n          if (!response.ok) {\n            throw new _types.FunctionsHttpError(response);\n          }\n          let responseType = ((_a = response.headers.get('Content-Type')) !== null && _a !== void 0 ? _a : 'text/plain').split(';')[0].trim();\n          let data;\n          if (responseType === 'application/json') {\n            data = yield response.json();\n          } else if (responseType === 'application/octet-stream' || responseType === 'application/pdf') {\n            data = yield response.blob();\n          } else if (responseType === 'text/event-stream') {\n            data = response;\n          } else if (responseType === 'multipart/form-data') {\n            data = yield response.formData();\n          } else {\n            // default to text\n            data = yield response.text();\n          }\n          return {\n            data,\n            error: null,\n            response\n          };\n        } catch (error) {\n          if (error instanceof Error && error.name === 'AbortError') {\n            return {\n              data: null,\n              error: new _types.FunctionsFetchError(error)\n            };\n          }\n          return {\n            data: null,\n            error,\n            response: error instanceof _types.FunctionsHttpError || error instanceof _types.FunctionsRelayError ? error.context : undefined\n          };\n        }\n      });\n    }\n  }\n});","lineCount":143,"map":[[7,2,4,0,"Object"],[7,8,4,0],[7,9,4,0,"defineProperty"],[7,23,4,0],[7,24,4,0,"exports"],[7,31,4,0],[8,4,4,0,"enumerable"],[8,14,4,0],[9,4,4,0,"get"],[9,7,4,0],[9,18,4,0,"get"],[9,19,4,0],[10,6,4,0],[10,13,4,0,"FunctionsClient"],[10,28,4,0],[11,4,4,0],[12,2,4,0],[13,2,1,0],[13,6,1,0,"_tslib"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_helper"],[14,13,2,0],[14,16,2,0,"require"],[14,23,2,0],[14,24,2,0,"_dependencyMap"],[14,38,2,0],[15,2,3,0],[15,6,3,0,"_types"],[15,12,3,0],[15,15,3,0,"require"],[15,22,3,0],[15,23,3,0,"_dependencyMap"],[15,37,3,0],[16,2,4,7],[16,8,4,13,"FunctionsClient"],[16,23,4,28],[16,24,4,29],[17,4,5,4,"constructor"],[17,15,5,15,"constructor"],[17,16,5,16,"url"],[17,19,5,19],[17,21,5,21],[18,6,5,23,"headers"],[18,13,5,30],[18,16,5,33],[18,17,5,34],[18,18,5,35],[19,6,5,37,"customFetch"],[19,17,5,48],[20,6,5,50,"region"],[20,12,5,56],[20,15,5,59,"FunctionRegion"],[20,21,5,73],[20,22,5,73,"FunctionRegion"],[20,36,5,73],[20,37,5,74,"Any"],[21,4,5,79],[21,5,5,80],[21,8,5,83],[21,9,5,84],[21,10,5,85],[21,12,5,87],[22,6,6,8],[22,10,6,12],[22,11,6,13,"url"],[22,14,6,16],[22,17,6,19,"url"],[22,20,6,22],[23,6,7,8],[23,10,7,12],[23,11,7,13,"headers"],[23,18,7,20],[23,21,7,23,"headers"],[23,28,7,30],[24,6,8,8],[24,10,8,12],[24,11,8,13,"region"],[24,17,8,19],[24,20,8,22,"region"],[24,26,8,28],[25,6,9,8],[25,10,9,12],[25,11,9,13,"fetch"],[25,16,9,18],[25,19,9,21],[25,23,9,21,"resolveFetch"],[25,30,9,33],[25,31,9,33,"resolveFetch"],[25,43,9,33],[25,45,9,34,"customFetch"],[25,56,9,45],[25,57,9,46],[26,4,10,4],[27,4,11,4],[28,0,12,0],[29,0,13,0],[30,0,14,0],[31,4,15,4,"setAuth"],[31,11,15,11,"setAuth"],[31,12,15,12,"token"],[31,17,15,17],[31,19,15,19],[32,6,16,8],[32,10,16,12],[32,11,16,13,"headers"],[32,18,16,20],[32,19,16,21,"Authorization"],[32,32,16,34],[32,35,16,37],[32,45,16,47,"token"],[32,50,16,52],[32,52,16,54],[33,4,17,4],[34,4,18,4],[35,0,19,0],[36,0,20,0],[37,0,21,0],[38,0,22,0],[39,4,23,4,"invoke"],[39,10,23,10,"invoke"],[39,11,23,11,"functionName_1"],[39,25,23,25],[39,27,23,27],[40,6,24,8],[40,13,24,15],[40,17,24,15,"__awaiter"],[40,23,24,24],[40,24,24,24,"__awaiter"],[40,33,24,24],[40,35,24,25],[40,39,24,29],[40,41,24,31,"arguments"],[40,50,24,40],[40,52,24,42],[40,57,24,47],[40,58,24,48],[40,60,24,50],[40,71,24,61,"functionName"],[40,83,24,73],[40,85,24,75,"options"],[40,92,24,82],[40,95,24,85],[40,96,24,86],[40,97,24,87],[40,99,24,89],[41,8,25,12],[41,12,25,16,"_a"],[41,14,25,18],[42,8,26,12],[42,12,26,16],[43,10,27,16],[43,16,27,22],[44,12,27,24,"headers"],[44,19,27,31],[45,12,27,33,"method"],[45,18,27,39],[46,12,27,41,"body"],[46,16,27,45],[46,18,27,47,"functionArgs"],[46,30,27,59],[47,12,27,61,"signal"],[48,10,27,68],[48,11,27,69],[48,14,27,72,"options"],[48,21,27,79],[49,10,28,16],[49,14,28,20,"_headers"],[49,22,28,28],[49,25,28,31],[49,26,28,32],[49,27,28,33],[50,10,29,16],[50,14,29,20],[51,12,29,22,"region"],[52,10,29,29],[52,11,29,30],[52,14,29,33,"options"],[52,21,29,40],[53,10,30,16],[53,14,30,20],[53,15,30,21,"region"],[53,21,30,27],[53,23,30,29],[54,12,31,20,"region"],[54,18,31,26],[54,21,31,29],[54,25,31,33],[54,26,31,34,"region"],[54,32,31,40],[55,10,32,16],[56,10,33,16],[57,10,34,16],[57,16,34,22,"url"],[57,19,34,25],[57,22,34,28],[57,26,34,32,"URL"],[57,29,34,35],[57,30,34,36],[57,33,34,39],[57,37,34,43],[57,38,34,44,"url"],[57,41,34,47],[57,45,34,51,"functionName"],[57,57,34,63],[57,59,34,65],[57,60,34,66],[58,10,35,16],[58,14,35,20,"region"],[58,20,35,26],[58,24,35,30,"region"],[58,30,35,36],[58,35,35,41],[58,40,35,46],[58,42,35,48],[59,12,36,20,"_headers"],[59,20,36,28],[59,21,36,29],[59,31,36,39],[59,32,36,40],[59,35,36,43,"region"],[59,41,36,49],[60,12,37,20,"url"],[60,15,37,23],[60,16,37,24,"searchParams"],[60,28,37,36],[60,29,37,37,"set"],[60,32,37,40],[60,33,37,41],[60,54,37,62],[60,56,37,64,"region"],[60,62,37,70],[60,63,37,71],[61,10,38,16],[62,10,39,16],[62,14,39,20,"body"],[62,18,39,24],[63,10,40,16],[63,14,40,20,"functionArgs"],[63,26,40,32],[63,31,41,22,"headers"],[63,38,41,29],[63,42,41,33],[63,43,41,34,"Object"],[63,49,41,40],[63,50,41,41,"prototype"],[63,59,41,50],[63,60,41,51,"hasOwnProperty"],[63,74,41,65],[63,75,41,66,"call"],[63,79,41,70],[63,80,41,71,"headers"],[63,87,41,78],[63,89,41,80],[63,103,41,94],[63,104,41,95],[63,108,41,100],[63,109,41,101,"headers"],[63,116,41,108],[63,117,41,109],[63,119,41,111],[64,12,42,20],[64,16,42,25],[64,23,42,32,"Blob"],[64,27,42,36],[64,32,42,41],[64,43,42,52],[64,47,42,56,"functionArgs"],[64,59,42,68],[64,71,42,80,"Blob"],[64,75,42,84],[64,79,43,24,"functionArgs"],[64,91,43,36],[64,103,43,48,"ArrayBuffer"],[64,114,43,59],[64,116,43,61],[65,14,44,24],[66,14,45,24],[67,14,46,24,"_headers"],[67,22,46,32],[67,23,46,33],[67,37,46,47],[67,38,46,48],[67,41,46,51],[67,67,46,77],[68,14,47,24,"body"],[68,18,47,28],[68,21,47,31,"functionArgs"],[68,33,47,43],[69,12,48,20],[69,13,48,21],[69,19,49,25],[69,23,49,29],[69,30,49,36,"functionArgs"],[69,42,49,48],[69,47,49,53],[69,55,49,61],[69,57,49,63],[70,14,50,24],[71,14,51,24,"_headers"],[71,22,51,32],[71,23,51,33],[71,37,51,47],[71,38,51,48],[71,41,51,51],[71,53,51,63],[72,14,52,24,"body"],[72,18,52,28],[72,21,52,31,"functionArgs"],[72,33,52,43],[73,12,53,20],[73,13,53,21],[73,19,54,25],[73,23,54,29],[73,30,54,36,"FormData"],[73,38,54,44],[73,43,54,49],[73,54,54,60],[73,58,54,64,"functionArgs"],[73,70,54,76],[73,82,54,88,"FormData"],[73,90,54,96],[73,92,54,98],[74,14,55,24],[75,14,56,24],[76,14,57,24,"body"],[76,18,57,28],[76,21,57,31,"functionArgs"],[76,33,57,43],[77,12,58,20],[77,13,58,21],[77,19,59,25],[78,14,60,24],[79,14,61,24,"_headers"],[79,22,61,32],[79,23,61,33],[79,37,61,47],[79,38,61,48],[79,41,61,51],[79,59,61,69],[80,14,62,24,"body"],[80,18,62,28],[80,21,62,31,"JSON"],[80,25,62,35],[80,26,62,36,"stringify"],[80,35,62,45],[80,36,62,46,"functionArgs"],[80,48,62,58],[80,49,62,59],[81,12,63,20],[82,10,64,16],[82,11,64,17],[82,17,65,21],[83,12,66,20],[84,12,67,20,"body"],[84,16,67,24],[84,19,67,27,"functionArgs"],[84,31,67,39],[85,10,68,16],[86,10,69,16],[86,16,69,22,"response"],[86,24,69,30],[86,27,69,33],[86,33,69,39],[86,37,69,43],[86,38,69,44,"fetch"],[86,43,69,49],[86,44,69,50,"url"],[86,47,69,53],[86,48,69,54,"toString"],[86,56,69,62],[86,57,69,63],[86,58,69,64],[86,60,69,66],[87,12,70,20,"method"],[87,18,70,26],[87,20,70,28,"method"],[87,26,70,34],[87,30,70,38],[87,36,70,44],[88,12,71,20],[89,12,72,20],[90,12,73,20],[91,12,74,20],[92,12,75,20,"headers"],[92,19,75,27],[92,21,75,29,"Object"],[92,27,75,35],[92,28,75,36,"assign"],[92,34,75,42],[92,35,75,43,"Object"],[92,41,75,49],[92,42,75,50,"assign"],[92,48,75,56],[92,49,75,57,"Object"],[92,55,75,63],[92,56,75,64,"assign"],[92,62,75,70],[92,63,75,71],[92,64,75,72],[92,65,75,73],[92,67,75,75,"_headers"],[92,75,75,83],[92,76,75,84],[92,78,75,86],[92,82,75,90],[92,83,75,91,"headers"],[92,90,75,98],[92,91,75,99],[92,93,75,101,"headers"],[92,100,75,108],[92,101,75,109],[93,12,76,20,"body"],[93,16,76,24],[94,12,77,20,"signal"],[95,10,78,16],[95,11,78,17],[95,12,78,18],[95,13,78,19,"catch"],[95,18,78,24],[95,19,78,26,"fetchError"],[95,29,78,36],[95,33,78,41],[96,12,79,20],[96,16,79,24,"fetchError"],[96,26,79,34],[96,27,79,35,"name"],[96,31,79,39],[96,36,79,44],[96,48,79,56],[96,50,79,58],[97,14,80,24],[97,20,80,30,"fetchError"],[97,30,80,40],[98,12,81,20],[99,12,82,20],[99,18,82,26],[99,22,82,30,"FunctionsFetchError"],[99,28,82,49],[99,29,82,49,"FunctionsFetchError"],[99,48,82,49],[99,49,82,50,"fetchError"],[99,59,82,60],[99,60,82,61],[100,10,83,16],[100,11,83,17],[100,12,83,18],[101,10,84,16],[101,16,84,22,"isRelayError"],[101,28,84,34],[101,31,84,37,"response"],[101,39,84,45],[101,40,84,46,"headers"],[101,47,84,53],[101,48,84,54,"get"],[101,51,84,57],[101,52,84,58],[101,67,84,73],[101,68,84,74],[102,10,85,16],[102,14,85,20,"isRelayError"],[102,26,85,32],[102,30,85,36,"isRelayError"],[102,42,85,48],[102,47,85,53],[102,53,85,59],[102,55,85,61],[103,12,86,20],[103,18,86,26],[103,22,86,30,"FunctionsRelayError"],[103,28,86,49],[103,29,86,49,"FunctionsRelayError"],[103,48,86,49],[103,49,86,50,"response"],[103,57,86,58],[103,58,86,59],[104,10,87,16],[105,10,88,16],[105,14,88,20],[105,15,88,21,"response"],[105,23,88,29],[105,24,88,30,"ok"],[105,26,88,32],[105,28,88,34],[106,12,89,20],[106,18,89,26],[106,22,89,30,"FunctionsHttpError"],[106,28,89,48],[106,29,89,48,"FunctionsHttpError"],[106,47,89,48],[106,48,89,49,"response"],[106,56,89,57],[106,57,89,58],[107,10,90,16],[108,10,91,16],[108,14,91,20,"responseType"],[108,26,91,32],[108,29,91,35],[108,30,91,36],[108,31,91,37,"_a"],[108,33,91,39],[108,36,91,42,"response"],[108,44,91,50],[108,45,91,51,"headers"],[108,52,91,58],[108,53,91,59,"get"],[108,56,91,62],[108,57,91,63],[108,71,91,77],[108,72,91,78],[108,78,91,84],[108,82,91,88],[108,86,91,92,"_a"],[108,88,91,94],[108,93,91,99],[108,98,91,104],[108,99,91,105],[108,102,91,108,"_a"],[108,104,91,110],[108,107,91,113],[108,119,91,125],[108,121,91,127,"split"],[108,126,91,132],[108,127,91,133],[108,130,91,136],[108,131,91,137],[108,132,91,138],[108,133,91,139],[108,134,91,140],[108,135,91,141,"trim"],[108,139,91,145],[108,140,91,146],[108,141,91,147],[109,10,92,16],[109,14,92,20,"data"],[109,18,92,24],[110,10,93,16],[110,14,93,20,"responseType"],[110,26,93,32],[110,31,93,37],[110,49,93,55],[110,51,93,57],[111,12,94,20,"data"],[111,16,94,24],[111,19,94,27],[111,25,94,33,"response"],[111,33,94,41],[111,34,94,42,"json"],[111,38,94,46],[111,39,94,47],[111,40,94,48],[112,10,95,16],[112,11,95,17],[112,17,96,21],[112,21,96,25,"responseType"],[112,33,96,37],[112,38,96,42],[112,64,96,68],[112,68,97,20,"responseType"],[112,80,97,32],[112,85,97,37],[112,102,97,54],[112,104,97,56],[113,12,98,20,"data"],[113,16,98,24],[113,19,98,27],[113,25,98,33,"response"],[113,33,98,41],[113,34,98,42,"blob"],[113,38,98,46],[113,39,98,47],[113,40,98,48],[114,10,99,16],[114,11,99,17],[114,17,100,21],[114,21,100,25,"responseType"],[114,33,100,37],[114,38,100,42],[114,57,100,61],[114,59,100,63],[115,12,101,20,"data"],[115,16,101,24],[115,19,101,27,"response"],[115,27,101,35],[116,10,102,16],[116,11,102,17],[116,17,103,21],[116,21,103,25,"responseType"],[116,33,103,37],[116,38,103,42],[116,59,103,63],[116,61,103,65],[117,12,104,20,"data"],[117,16,104,24],[117,19,104,27],[117,25,104,33,"response"],[117,33,104,41],[117,34,104,42,"formData"],[117,42,104,50],[117,43,104,51],[117,44,104,52],[118,10,105,16],[118,11,105,17],[118,17,106,21],[119,12,107,20],[120,12,108,20,"data"],[120,16,108,24],[120,19,108,27],[120,25,108,33,"response"],[120,33,108,41],[120,34,108,42,"text"],[120,38,108,46],[120,39,108,47],[120,40,108,48],[121,10,109,16],[122,10,110,16],[122,17,110,23],[123,12,110,25,"data"],[123,16,110,29],[124,12,110,31,"error"],[124,17,110,36],[124,19,110,38],[124,23,110,42],[125,12,110,44,"response"],[126,10,110,53],[126,11,110,54],[127,8,111,12],[127,9,111,13],[127,10,112,12],[127,17,112,19,"error"],[127,22,112,24],[127,24,112,26],[128,10,113,16],[128,14,113,20,"error"],[128,19,113,25],[128,31,113,37,"Error"],[128,36,113,42],[128,40,113,46,"error"],[128,45,113,51],[128,46,113,52,"name"],[128,50,113,56],[128,55,113,61],[128,67,113,73],[128,69,113,75],[129,12,114,20],[129,19,114,27],[130,14,114,29,"data"],[130,18,114,33],[130,20,114,35],[130,24,114,39],[131,14,114,41,"error"],[131,19,114,46],[131,21,114,48],[131,25,114,52,"FunctionsFetchError"],[131,31,114,71],[131,32,114,71,"FunctionsFetchError"],[131,51,114,71],[131,52,114,72,"error"],[131,57,114,77],[132,12,114,79],[132,13,114,80],[133,10,115,16],[134,10,116,16],[134,17,116,23],[135,12,117,20,"data"],[135,16,117,24],[135,18,117,26],[135,22,117,30],[136,12,118,20,"error"],[136,17,118,25],[137,12,119,20,"response"],[137,20,119,28],[137,22,119,30,"error"],[137,27,119,35],[137,39,119,47,"FunctionsHttpError"],[137,45,119,65],[137,46,119,65,"FunctionsHttpError"],[137,64,119,65],[137,68,119,69,"error"],[137,73,119,74],[137,85,119,86,"FunctionsRelayError"],[137,91,119,105],[137,92,119,105,"FunctionsRelayError"],[137,111,119,105],[137,114,120,26,"error"],[137,119,120,31],[137,120,120,32,"context"],[137,127,120,39],[137,130,121,26,"undefined"],[138,10,122,16],[138,11,122,17],[139,8,123,12],[140,6,124,8],[140,7,124,9],[140,8,124,10],[141,4,125,4],[142,2,126,0],[143,0,126,1],[143,3]],"functionMap":{"names":["<global>","FunctionsClient","constructor","setAuth","invoke","__awaiter$argument_3","fetch._catch$argument_0"],"mappings":"AAA;OCG;ICC;KDK;IEK;KFE;IGM;kDCC;yBCsD;iBDK;SDyC;KHC;CDC"},"hasCjsExports":false},"type":"js/module"}]}