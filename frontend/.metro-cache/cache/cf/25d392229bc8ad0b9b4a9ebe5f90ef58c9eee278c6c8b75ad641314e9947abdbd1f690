{"dependencies":[{"name":"tslib","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":16,"index":127},"end":{"line":4,"column":32,"index":143}}],"key":"vm88vOsSPZItrLOmMEyUuGkd1y4=","exportNames":["*"],"imports":1}},{"name":"./helper","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":17,"index":162},"end":{"line":5,"column":36,"index":181}}],"key":"/EynIj/Q6/U8HhCpVkhfD/9nus0=","exportNames":["*"],"imports":1}},{"name":"./types","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":16,"index":199},"end":{"line":6,"column":34,"index":217}}],"key":"iU0PUTt27rZ09z7DeRf4jWGkzmo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.FunctionsClient = void 0;\n  const tslib_1 = require(_dependencyMap[0], \"tslib\");\n  const helper_1 = require(_dependencyMap[1], \"./helper\");\n  const types_1 = require(_dependencyMap[2], \"./types\");\n  class FunctionsClient {\n    constructor(url, {\n      headers = {},\n      customFetch,\n      region = types_1.FunctionRegion.Any\n    } = {}) {\n      this.url = url;\n      this.headers = headers;\n      this.region = region;\n      this.fetch = (0, helper_1.resolveFetch)(customFetch);\n    }\n    /**\n     * Updates the authorization header\n     * @param token - the new jwt token sent in the authorisation header\n     */\n    setAuth(token) {\n      this.headers.Authorization = `Bearer ${token}`;\n    }\n    /**\n     * Invokes a function\n     * @param functionName - The name of the Function to invoke.\n     * @param options - Options for invoking the Function.\n     */\n    invoke(functionName_1) {\n      return tslib_1.__awaiter(this, arguments, void 0, function* (functionName, options = {}) {\n        var _a;\n        try {\n          const {\n            headers,\n            method,\n            body: functionArgs,\n            signal\n          } = options;\n          let _headers = {};\n          let {\n            region\n          } = options;\n          if (!region) {\n            region = this.region;\n          }\n          // Add region as query parameter using URL API\n          const url = new URL(`${this.url}/${functionName}`);\n          if (region && region !== 'any') {\n            _headers['x-region'] = region;\n            url.searchParams.set('forceFunctionRegion', region);\n          }\n          let body;\n          if (functionArgs && (headers && !Object.prototype.hasOwnProperty.call(headers, 'Content-Type') || !headers)) {\n            if (typeof Blob !== 'undefined' && functionArgs instanceof Blob || functionArgs instanceof ArrayBuffer) {\n              // will work for File as File inherits Blob\n              // also works for ArrayBuffer as it is the same underlying structure as a Blob\n              _headers['Content-Type'] = 'application/octet-stream';\n              body = functionArgs;\n            } else if (typeof functionArgs === 'string') {\n              // plain string\n              _headers['Content-Type'] = 'text/plain';\n              body = functionArgs;\n            } else if (typeof FormData !== 'undefined' && functionArgs instanceof FormData) {\n              // don't set content-type headers\n              // Request will automatically add the right boundary value\n              body = functionArgs;\n            } else {\n              // default, assume this is JSON\n              _headers['Content-Type'] = 'application/json';\n              body = JSON.stringify(functionArgs);\n            }\n          } else {\n            // if the Content-Type was supplied, simply set the body\n            body = functionArgs;\n          }\n          const response = yield this.fetch(url.toString(), {\n            method: method || 'POST',\n            // headers priority is (high to low):\n            // 1. invoke-level headers\n            // 2. client-level headers\n            // 3. default Content-Type header\n            headers: Object.assign(Object.assign(Object.assign({}, _headers), this.headers), headers),\n            body,\n            signal\n          }).catch(fetchError => {\n            if (fetchError.name === 'AbortError') {\n              throw fetchError;\n            }\n            throw new types_1.FunctionsFetchError(fetchError);\n          });\n          const isRelayError = response.headers.get('x-relay-error');\n          if (isRelayError && isRelayError === 'true') {\n            throw new types_1.FunctionsRelayError(response);\n          }\n          if (!response.ok) {\n            throw new types_1.FunctionsHttpError(response);\n          }\n          let responseType = ((_a = response.headers.get('Content-Type')) !== null && _a !== void 0 ? _a : 'text/plain').split(';')[0].trim();\n          let data;\n          if (responseType === 'application/json') {\n            data = yield response.json();\n          } else if (responseType === 'application/octet-stream' || responseType === 'application/pdf') {\n            data = yield response.blob();\n          } else if (responseType === 'text/event-stream') {\n            data = response;\n          } else if (responseType === 'multipart/form-data') {\n            data = yield response.formData();\n          } else {\n            // default to text\n            data = yield response.text();\n          }\n          return {\n            data,\n            error: null,\n            response\n          };\n        } catch (error) {\n          if (error instanceof Error && error.name === 'AbortError') {\n            return {\n              data: null,\n              error: new types_1.FunctionsFetchError(error)\n            };\n          }\n          return {\n            data: null,\n            error,\n            response: error instanceof types_1.FunctionsHttpError || error instanceof types_1.FunctionsRelayError ? error.context : undefined\n          };\n        }\n      });\n    }\n  }\n  exports.FunctionsClient = FunctionsClient;\n});","lineCount":139,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"FunctionsClient"],[7,25,3,23],[7,28,3,26],[7,33,3,31],[7,34,3,32],[8,2,4,0],[8,8,4,6,"tslib_1"],[8,15,4,13],[8,18,4,16,"require"],[8,25,4,23],[8,26,4,23,"_dependencyMap"],[8,40,4,23],[8,52,4,31],[8,53,4,32],[9,2,5,0],[9,8,5,6,"helper_1"],[9,16,5,14],[9,19,5,17,"require"],[9,26,5,24],[9,27,5,24,"_dependencyMap"],[9,41,5,24],[9,56,5,35],[9,57,5,36],[10,2,6,0],[10,8,6,6,"types_1"],[10,15,6,13],[10,18,6,16,"require"],[10,25,6,23],[10,26,6,23,"_dependencyMap"],[10,40,6,23],[10,54,6,33],[10,55,6,34],[11,2,7,0],[11,8,7,6,"FunctionsClient"],[11,23,7,21],[11,24,7,22],[12,4,8,4,"constructor"],[12,15,8,15,"constructor"],[12,16,8,16,"url"],[12,19,8,19],[12,21,8,21],[13,6,8,23,"headers"],[13,13,8,30],[13,16,8,33],[13,17,8,34],[13,18,8,35],[14,6,8,37,"customFetch"],[14,17,8,48],[15,6,8,50,"region"],[15,12,8,56],[15,15,8,59,"types_1"],[15,22,8,66],[15,23,8,67,"FunctionRegion"],[15,37,8,81],[15,38,8,82,"Any"],[16,4,8,87],[16,5,8,88],[16,8,8,91],[16,9,8,92],[16,10,8,93],[16,12,8,95],[17,6,9,8],[17,10,9,12],[17,11,9,13,"url"],[17,14,9,16],[17,17,9,19,"url"],[17,20,9,22],[18,6,10,8],[18,10,10,12],[18,11,10,13,"headers"],[18,18,10,20],[18,21,10,23,"headers"],[18,28,10,30],[19,6,11,8],[19,10,11,12],[19,11,11,13,"region"],[19,17,11,19],[19,20,11,22,"region"],[19,26,11,28],[20,6,12,8],[20,10,12,12],[20,11,12,13,"fetch"],[20,16,12,18],[20,19,12,21],[20,20,12,22],[20,21,12,23],[20,23,12,25,"helper_1"],[20,31,12,33],[20,32,12,34,"resolveFetch"],[20,44,12,46],[20,46,12,48,"customFetch"],[20,57,12,59],[20,58,12,60],[21,4,13,4],[22,4,14,4],[23,0,15,0],[24,0,16,0],[25,0,17,0],[26,4,18,4,"setAuth"],[26,11,18,11,"setAuth"],[26,12,18,12,"token"],[26,17,18,17],[26,19,18,19],[27,6,19,8],[27,10,19,12],[27,11,19,13,"headers"],[27,18,19,20],[27,19,19,21,"Authorization"],[27,32,19,34],[27,35,19,37],[27,45,19,47,"token"],[27,50,19,52],[27,52,19,54],[28,4,20,4],[29,4,21,4],[30,0,22,0],[31,0,23,0],[32,0,24,0],[33,0,25,0],[34,4,26,4,"invoke"],[34,10,26,10,"invoke"],[34,11,26,11,"functionName_1"],[34,25,26,25],[34,27,26,27],[35,6,27,8],[35,13,27,15,"tslib_1"],[35,20,27,22],[35,21,27,23,"__awaiter"],[35,30,27,32],[35,31,27,33],[35,35,27,37],[35,37,27,39,"arguments"],[35,46,27,48],[35,48,27,50],[35,53,27,55],[35,54,27,56],[35,56,27,58],[35,67,27,69,"functionName"],[35,79,27,81],[35,81,27,83,"options"],[35,88,27,90],[35,91,27,93],[35,92,27,94],[35,93,27,95],[35,95,27,97],[36,8,28,12],[36,12,28,16,"_a"],[36,14,28,18],[37,8,29,12],[37,12,29,16],[38,10,30,16],[38,16,30,22],[39,12,30,24,"headers"],[39,19,30,31],[40,12,30,33,"method"],[40,18,30,39],[41,12,30,41,"body"],[41,16,30,45],[41,18,30,47,"functionArgs"],[41,30,30,59],[42,12,30,61,"signal"],[43,10,30,68],[43,11,30,69],[43,14,30,72,"options"],[43,21,30,79],[44,10,31,16],[44,14,31,20,"_headers"],[44,22,31,28],[44,25,31,31],[44,26,31,32],[44,27,31,33],[45,10,32,16],[45,14,32,20],[46,12,32,22,"region"],[47,10,32,29],[47,11,32,30],[47,14,32,33,"options"],[47,21,32,40],[48,10,33,16],[48,14,33,20],[48,15,33,21,"region"],[48,21,33,27],[48,23,33,29],[49,12,34,20,"region"],[49,18,34,26],[49,21,34,29],[49,25,34,33],[49,26,34,34,"region"],[49,32,34,40],[50,10,35,16],[51,10,36,16],[52,10,37,16],[52,16,37,22,"url"],[52,19,37,25],[52,22,37,28],[52,26,37,32,"URL"],[52,29,37,35],[52,30,37,36],[52,33,37,39],[52,37,37,43],[52,38,37,44,"url"],[52,41,37,47],[52,45,37,51,"functionName"],[52,57,37,63],[52,59,37,65],[52,60,37,66],[53,10,38,16],[53,14,38,20,"region"],[53,20,38,26],[53,24,38,30,"region"],[53,30,38,36],[53,35,38,41],[53,40,38,46],[53,42,38,48],[54,12,39,20,"_headers"],[54,20,39,28],[54,21,39,29],[54,31,39,39],[54,32,39,40],[54,35,39,43,"region"],[54,41,39,49],[55,12,40,20,"url"],[55,15,40,23],[55,16,40,24,"searchParams"],[55,28,40,36],[55,29,40,37,"set"],[55,32,40,40],[55,33,40,41],[55,54,40,62],[55,56,40,64,"region"],[55,62,40,70],[55,63,40,71],[56,10,41,16],[57,10,42,16],[57,14,42,20,"body"],[57,18,42,24],[58,10,43,16],[58,14,43,20,"functionArgs"],[58,26,43,32],[58,31,44,22,"headers"],[58,38,44,29],[58,42,44,33],[58,43,44,34,"Object"],[58,49,44,40],[58,50,44,41,"prototype"],[58,59,44,50],[58,60,44,51,"hasOwnProperty"],[58,74,44,65],[58,75,44,66,"call"],[58,79,44,70],[58,80,44,71,"headers"],[58,87,44,78],[58,89,44,80],[58,103,44,94],[58,104,44,95],[58,108,44,100],[58,109,44,101,"headers"],[58,116,44,108],[58,117,44,109],[58,119,44,111],[59,12,45,20],[59,16,45,25],[59,23,45,32,"Blob"],[59,27,45,36],[59,32,45,41],[59,43,45,52],[59,47,45,56,"functionArgs"],[59,59,45,68],[59,71,45,80,"Blob"],[59,75,45,84],[59,79,46,24,"functionArgs"],[59,91,46,36],[59,103,46,48,"ArrayBuffer"],[59,114,46,59],[59,116,46,61],[60,14,47,24],[61,14,48,24],[62,14,49,24,"_headers"],[62,22,49,32],[62,23,49,33],[62,37,49,47],[62,38,49,48],[62,41,49,51],[62,67,49,77],[63,14,50,24,"body"],[63,18,50,28],[63,21,50,31,"functionArgs"],[63,33,50,43],[64,12,51,20],[64,13,51,21],[64,19,52,25],[64,23,52,29],[64,30,52,36,"functionArgs"],[64,42,52,48],[64,47,52,53],[64,55,52,61],[64,57,52,63],[65,14,53,24],[66,14,54,24,"_headers"],[66,22,54,32],[66,23,54,33],[66,37,54,47],[66,38,54,48],[66,41,54,51],[66,53,54,63],[67,14,55,24,"body"],[67,18,55,28],[67,21,55,31,"functionArgs"],[67,33,55,43],[68,12,56,20],[68,13,56,21],[68,19,57,25],[68,23,57,29],[68,30,57,36,"FormData"],[68,38,57,44],[68,43,57,49],[68,54,57,60],[68,58,57,64,"functionArgs"],[68,70,57,76],[68,82,57,88,"FormData"],[68,90,57,96],[68,92,57,98],[69,14,58,24],[70,14,59,24],[71,14,60,24,"body"],[71,18,60,28],[71,21,60,31,"functionArgs"],[71,33,60,43],[72,12,61,20],[72,13,61,21],[72,19,62,25],[73,14,63,24],[74,14,64,24,"_headers"],[74,22,64,32],[74,23,64,33],[74,37,64,47],[74,38,64,48],[74,41,64,51],[74,59,64,69],[75,14,65,24,"body"],[75,18,65,28],[75,21,65,31,"JSON"],[75,25,65,35],[75,26,65,36,"stringify"],[75,35,65,45],[75,36,65,46,"functionArgs"],[75,48,65,58],[75,49,65,59],[76,12,66,20],[77,10,67,16],[77,11,67,17],[77,17,68,21],[78,12,69,20],[79,12,70,20,"body"],[79,16,70,24],[79,19,70,27,"functionArgs"],[79,31,70,39],[80,10,71,16],[81,10,72,16],[81,16,72,22,"response"],[81,24,72,30],[81,27,72,33],[81,33,72,39],[81,37,72,43],[81,38,72,44,"fetch"],[81,43,72,49],[81,44,72,50,"url"],[81,47,72,53],[81,48,72,54,"toString"],[81,56,72,62],[81,57,72,63],[81,58,72,64],[81,60,72,66],[82,12,73,20,"method"],[82,18,73,26],[82,20,73,28,"method"],[82,26,73,34],[82,30,73,38],[82,36,73,44],[83,12,74,20],[84,12,75,20],[85,12,76,20],[86,12,77,20],[87,12,78,20,"headers"],[87,19,78,27],[87,21,78,29,"Object"],[87,27,78,35],[87,28,78,36,"assign"],[87,34,78,42],[87,35,78,43,"Object"],[87,41,78,49],[87,42,78,50,"assign"],[87,48,78,56],[87,49,78,57,"Object"],[87,55,78,63],[87,56,78,64,"assign"],[87,62,78,70],[87,63,78,71],[87,64,78,72],[87,65,78,73],[87,67,78,75,"_headers"],[87,75,78,83],[87,76,78,84],[87,78,78,86],[87,82,78,90],[87,83,78,91,"headers"],[87,90,78,98],[87,91,78,99],[87,93,78,101,"headers"],[87,100,78,108],[87,101,78,109],[88,12,79,20,"body"],[88,16,79,24],[89,12,80,20,"signal"],[90,10,81,16],[90,11,81,17],[90,12,81,18],[90,13,81,19,"catch"],[90,18,81,24],[90,19,81,26,"fetchError"],[90,29,81,36],[90,33,81,41],[91,12,82,20],[91,16,82,24,"fetchError"],[91,26,82,34],[91,27,82,35,"name"],[91,31,82,39],[91,36,82,44],[91,48,82,56],[91,50,82,58],[92,14,83,24],[92,20,83,30,"fetchError"],[92,30,83,40],[93,12,84,20],[94,12,85,20],[94,18,85,26],[94,22,85,30,"types_1"],[94,29,85,37],[94,30,85,38,"FunctionsFetchError"],[94,49,85,57],[94,50,85,58,"fetchError"],[94,60,85,68],[94,61,85,69],[95,10,86,16],[95,11,86,17],[95,12,86,18],[96,10,87,16],[96,16,87,22,"isRelayError"],[96,28,87,34],[96,31,87,37,"response"],[96,39,87,45],[96,40,87,46,"headers"],[96,47,87,53],[96,48,87,54,"get"],[96,51,87,57],[96,52,87,58],[96,67,87,73],[96,68,87,74],[97,10,88,16],[97,14,88,20,"isRelayError"],[97,26,88,32],[97,30,88,36,"isRelayError"],[97,42,88,48],[97,47,88,53],[97,53,88,59],[97,55,88,61],[98,12,89,20],[98,18,89,26],[98,22,89,30,"types_1"],[98,29,89,37],[98,30,89,38,"FunctionsRelayError"],[98,49,89,57],[98,50,89,58,"response"],[98,58,89,66],[98,59,89,67],[99,10,90,16],[100,10,91,16],[100,14,91,20],[100,15,91,21,"response"],[100,23,91,29],[100,24,91,30,"ok"],[100,26,91,32],[100,28,91,34],[101,12,92,20],[101,18,92,26],[101,22,92,30,"types_1"],[101,29,92,37],[101,30,92,38,"FunctionsHttpError"],[101,48,92,56],[101,49,92,57,"response"],[101,57,92,65],[101,58,92,66],[102,10,93,16],[103,10,94,16],[103,14,94,20,"responseType"],[103,26,94,32],[103,29,94,35],[103,30,94,36],[103,31,94,37,"_a"],[103,33,94,39],[103,36,94,42,"response"],[103,44,94,50],[103,45,94,51,"headers"],[103,52,94,58],[103,53,94,59,"get"],[103,56,94,62],[103,57,94,63],[103,71,94,77],[103,72,94,78],[103,78,94,84],[103,82,94,88],[103,86,94,92,"_a"],[103,88,94,94],[103,93,94,99],[103,98,94,104],[103,99,94,105],[103,102,94,108,"_a"],[103,104,94,110],[103,107,94,113],[103,119,94,125],[103,121,94,127,"split"],[103,126,94,132],[103,127,94,133],[103,130,94,136],[103,131,94,137],[103,132,94,138],[103,133,94,139],[103,134,94,140],[103,135,94,141,"trim"],[103,139,94,145],[103,140,94,146],[103,141,94,147],[104,10,95,16],[104,14,95,20,"data"],[104,18,95,24],[105,10,96,16],[105,14,96,20,"responseType"],[105,26,96,32],[105,31,96,37],[105,49,96,55],[105,51,96,57],[106,12,97,20,"data"],[106,16,97,24],[106,19,97,27],[106,25,97,33,"response"],[106,33,97,41],[106,34,97,42,"json"],[106,38,97,46],[106,39,97,47],[106,40,97,48],[107,10,98,16],[107,11,98,17],[107,17,99,21],[107,21,99,25,"responseType"],[107,33,99,37],[107,38,99,42],[107,64,99,68],[107,68,100,20,"responseType"],[107,80,100,32],[107,85,100,37],[107,102,100,54],[107,104,100,56],[108,12,101,20,"data"],[108,16,101,24],[108,19,101,27],[108,25,101,33,"response"],[108,33,101,41],[108,34,101,42,"blob"],[108,38,101,46],[108,39,101,47],[108,40,101,48],[109,10,102,16],[109,11,102,17],[109,17,103,21],[109,21,103,25,"responseType"],[109,33,103,37],[109,38,103,42],[109,57,103,61],[109,59,103,63],[110,12,104,20,"data"],[110,16,104,24],[110,19,104,27,"response"],[110,27,104,35],[111,10,105,16],[111,11,105,17],[111,17,106,21],[111,21,106,25,"responseType"],[111,33,106,37],[111,38,106,42],[111,59,106,63],[111,61,106,65],[112,12,107,20,"data"],[112,16,107,24],[112,19,107,27],[112,25,107,33,"response"],[112,33,107,41],[112,34,107,42,"formData"],[112,42,107,50],[112,43,107,51],[112,44,107,52],[113,10,108,16],[113,11,108,17],[113,17,109,21],[114,12,110,20],[115,12,111,20,"data"],[115,16,111,24],[115,19,111,27],[115,25,111,33,"response"],[115,33,111,41],[115,34,111,42,"text"],[115,38,111,46],[115,39,111,47],[115,40,111,48],[116,10,112,16],[117,10,113,16],[117,17,113,23],[118,12,113,25,"data"],[118,16,113,29],[119,12,113,31,"error"],[119,17,113,36],[119,19,113,38],[119,23,113,42],[120,12,113,44,"response"],[121,10,113,53],[121,11,113,54],[122,8,114,12],[122,9,114,13],[122,10,115,12],[122,17,115,19,"error"],[122,22,115,24],[122,24,115,26],[123,10,116,16],[123,14,116,20,"error"],[123,19,116,25],[123,31,116,37,"Error"],[123,36,116,42],[123,40,116,46,"error"],[123,45,116,51],[123,46,116,52,"name"],[123,50,116,56],[123,55,116,61],[123,67,116,73],[123,69,116,75],[124,12,117,20],[124,19,117,27],[125,14,117,29,"data"],[125,18,117,33],[125,20,117,35],[125,24,117,39],[126,14,117,41,"error"],[126,19,117,46],[126,21,117,48],[126,25,117,52,"types_1"],[126,32,117,59],[126,33,117,60,"FunctionsFetchError"],[126,52,117,79],[126,53,117,80,"error"],[126,58,117,85],[127,12,117,87],[127,13,117,88],[128,10,118,16],[129,10,119,16],[129,17,119,23],[130,12,120,20,"data"],[130,16,120,24],[130,18,120,26],[130,22,120,30],[131,12,121,20,"error"],[131,17,121,25],[132,12,122,20,"response"],[132,20,122,28],[132,22,122,30,"error"],[132,27,122,35],[132,39,122,47,"types_1"],[132,46,122,54],[132,47,122,55,"FunctionsHttpError"],[132,65,122,73],[132,69,122,77,"error"],[132,74,122,82],[132,86,122,94,"types_1"],[132,93,122,101],[132,94,122,102,"FunctionsRelayError"],[132,113,122,121],[132,116,123,26,"error"],[132,121,123,31],[132,122,123,32,"context"],[132,129,123,39],[132,132,124,26,"undefined"],[133,10,125,16],[133,11,125,17],[134,8,126,12],[135,6,127,8],[135,7,127,9],[135,8,127,10],[136,4,128,4],[137,2,129,0],[138,2,130,0,"exports"],[138,9,130,7],[138,10,130,8,"FunctionsClient"],[138,25,130,23],[138,28,130,26,"FunctionsClient"],[138,43,130,41],[139,0,130,42],[139,3]],"functionMap":{"names":["<global>","FunctionsClient","constructor","setAuth","invoke","tslib_1.__awaiter$argument_3","fetch._catch$argument_0"],"mappings":"AAA;ACM;ICC;KDK;IEK;KFE;IGM;0DCC;yBCsD;iBDK;SDyC;KHC;CDC"},"hasCjsExports":true},"type":"js/module"}]}